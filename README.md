# Portfolio Backend

Express.js backend API for Mrityunjoy's portfolio with PostgreSQL database.

## Tech Stack

- **Framework**: Express.js 5
- **Database**: PostgreSQL
- **Authentication**: JWT + Passport.js
- **Security**: Helmet, CORS, Rate Limiting
- **File Handling**: Multer with secure presigned URLs

## Development Setup

1. **Install dependencies**:
   ```bash
   npm install
   ```

2. **Environment Configuration**:
   ```bash
   cp .env.example .env
   # Update DATABASE_URL and other secrets
   ```

3. **Database Setup**:
   ```bash
   npm run setup-db
   ```

4. **Start development server**:
   ```bash
   npm run dev
   ```

## Production Deployment

### Render Configuration

This project is configured for automatic Render deployment:

1. **Connect Repository**: Link your GitHub repo to Render
2. **Environment Variables**: Configure in Render dashboard (see .env.example)
3. **Database**: Render will create PostgreSQL instance automatically
4. **Deploy**: Render will build and deploy the web service

**Deploy Settings** (configured in `render.yaml`):
- Build command: `npm install`
- Start command: `npm start`
- Health check: `/api/health`

## Environment Variables

### Required for Production
- `NODE_ENV=production`
- `DATABASE_URL` - PostgreSQL connection string (auto-provided by Render)
- `JWT_SECRET` - JWT signing secret (auto-generated by Render)
- `SESSION_SECRET` - Session secret (auto-generated by Render)
- `FRONTEND_URL` - Your Netlify frontend URL

### Optional
- `PORT` - Server port (auto-assigned by Render)

## Available Scripts

- `npm start` - Start production server
- `npm run dev` - Start development server with nodemon
- `npm run setup-db` - Initialize database schema and seed data

## API Endpoints

### Public Endpoints
- `GET /api/health` - Health check
- `GET /api/profile` - Get profile information
- `GET /api/skills` - Get skills list
- `GET /api/experiences` - Get work experience
- `GET /api/projects` - Get projects list
- `POST /api/contact/submit` - Submit contact form

### Protected Endpoints (Admin)
- `POST /api/auth/login` - Admin login
- `GET /api/admin/dashboard/stats` - Dashboard statistics
- CRUD operations for skills, experiences, projects
- File upload and management

## Database

### Connection
Uses PostgreSQL with connection string format:
```
postgresql://username:password@hostname:port/database
```

### Schema
- Database schema in `db/schema.sql`
- Migrations in `db/migration-*.sql`
- Seed data in `db/seed.sql`

## Security Features

- **Helmet**: Security headers
- **CORS**: Cross-origin resource sharing
- **Rate Limiting**: API rate limits
- **JWT Authentication**: Secure token-based auth
- **Input Validation**: Express validator
- **Secure File Handling**: Presigned URLs for file access

## Deployment Requirements

### Production Checklist
- [ ] Environment variables configured
- [ ] Database connection working
- [ ] CORS configured for frontend domain
- [ ] Health check endpoint responding
- [ ] File upload functionality working
- [ ] Authentication system functional

### Render Deployment Steps
1. Create web service from GitHub repo
2. Set environment variables
3. Create PostgreSQL database
4. Deploy automatically on git push